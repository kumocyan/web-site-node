<% 
  var title = car.name + ' - 詳細情報';
  var description = car.description;
%>

<section class="section-block section-block--neutral">
  <div class="section-block__inner">
    <a href="/inventory" class="button button--outline mb-4"><i class="fas fa-arrow-left"></i> 在庫一覧に戻る</a>

    <div class="dual-column">
      <!-- 車両画像 -->
      <div class="dual-column__visual reveal">
        <% if (car.image_path) { %>
          <img src="<%= car.image_path %>" alt="<%= car.name %>" loading="lazy">
        <% } else { %>
          <div class="inventory-card__placeholder" style="min-height: 400px; display: flex; align-items: center; justify-content: center; background: var(--color-base-100);">
            <i class="fas fa-camera" style="font-size: 4rem; color: var(--color-ink-100);"></i>
          </div>
        <% } %>
      </div>

      <!-- 車両詳細情報 -->
      <div class="story-list reveal">
        <article class="story-list__item">
          <h2 class="story-list__title" style="font-size: 1.8rem; margin-bottom: 0.5rem;"><%= car.name %></h2>
          <p class="story-list__body" style="margin-top: 0;"><%= car.model || '' %></p>
        </article>

        <article class="story-list__item">
          <span class="story-list__tag"><i class="fas fa-yen-sign"></i> 価格</span>
          <p class="story-list__body" style="font-size: 1.8rem; font-weight: 700; color: var(--brand-primary); margin-top: 0.5rem;">
            <%= Math.round((Number(car.price) || 0) / 10000).toLocaleString('ja-JP') %>万円
            <span style="font-size: 1rem; font-weight: 400; color: var(--color-ink-200);">（税込）</span>
          </p>
        </article>

        <article class="story-list__item">
          <span class="story-list__tag"><i class="fas fa-info-circle"></i> 基本情報</span>
          <div style="display: grid; gap: 0.75rem; margin-top: 0.75rem;">
            <div><strong>年式:</strong> <%= car.year %>年式</div>
            <div><strong>走行距離:</strong> <%= car.mileage.toLocaleString() %>km</div>
            <div><strong>色:</strong> <%= car.color %></div>
            <div><strong>燃料種別:</strong> <%= car.fuel_type %></div>
            <div><strong>変速機:</strong> <%= car.transmission %></div>
            <div><strong>在庫状況:</strong>
              <% if (car.status === 'available') { %>
                <span class="badge" style="background: #31c48d; color: white; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.85rem;">在庫あり</span>
              <% } else if (car.status === 'reserved') { %>
                <span class="badge" style="background: #fbbf24; color: white; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.85rem;">予約中</span>
              <% } else { %>
                <span class="badge" style="background: #6b7280; color: white; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.85rem;">売約済み</span>
              <% } %>
            </div>
          </div>
        </article>

        <% if (car.description) { %>
        <article class="story-list__item">
          <span class="story-list__tag"><i class="fas fa-align-left"></i> 説明</span>
          <p class="story-list__body"><%= car.description %></p>
        </article>
        <% } %>

        <% if (car.features && Array.isArray(car.features) && car.features.length > 0) { %>
        <article class="story-list__item">
          <span class="story-list__tag"><i class="fas fa-check-circle"></i> 特徴・装備</span>
          <div style="display: grid; gap: 0.5rem; margin-top: 0.75rem;">
            <% car.features.forEach(feature => { %>
              <div style="padding: 0.5rem 1rem; background: rgba(86, 104, 255, 0.08); border-radius: var(--radius-sm); font-size: 0.95rem;">✅ <%= feature %></div>
            <% }); %>
          </div>
        </article>
        <% } %>

        <article class="story-list__item" style="padding: 1.5rem;">
          <h3 style="margin: 0 0 1rem 0; font-size: 1.2rem;">店舗情報</h3>
          <div style="display: grid; gap: 0.5rem;">
            <div><strong>N-STYLE <%= car.store_name ? `(${car.store_name})` : '' %></strong></div>
            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: var(--color-ink-200);">石狩市で創業20年</p>
            <ul style="margin: 0.75rem 0 0 0; padding-left: 1.5rem; font-size: 0.9rem; line-height: 1.8;">
              <li>✅ 全車整備保証付き</li>
              <li>✅ 充実のアフターサービス</li>
              <li>✅ 各種ローン取り扱い</li>
              <li>✅ 車検・点検もお任せください</li>
            </ul>
          </div>
        </article>

        <div style="display: flex; gap: 1rem; margin-top: 1rem;">
          <a href="/contact" class="button button--primary" style="flex: 1; justify-content: center;">
            <i class="fas fa-envelope-open-text"></i> お問い合わせ
          </a>
        </div>
      </div>
    </div>
  </div>
</section>
