# N-STYLE 中古車販売ウェブサイト - システム構成

## 📋 概要
N-STYLE中古車販売ウェブサイトは、Node.jsとExpress.jsを基盤としたフルスタックウェブアプリケーションです。SQLiteデータベースを使用し、中古車の在庫管理とユーザー向けの情報提供を行います。

## 🏗️ 技術スタック

### バックエンド
- **Node.js** v22.17.1
- **Express.js** v4.18.2 - ウェブフレームワーク
- **SQLite3** v5.1.7 - ファイルベースの軽量データベース
- **EJS** v3.1.9 - テンプレートエンジン
- **Method Override** v3.0.0 - HTTPメソッド拡張
- **Multer** v1.4.5-lts.1 - ファイルアップロード処理

### フロントエンド
- **Bootstrap 5.3.3** - CSSフレームワーク
- **Font Awesome 6.4.0** - アイコンフォント
- **Google Fonts (Noto Sans JP)** - 日本語フォント
- **Vanilla JavaScript** - インタラクティブ機能

### 開発環境
- **Nodemon** v3.0.2 - 自動再起動開発ツール

## 🗂️ プロジェクト構造

```
web-site/
├── doc/                    # ドキュメント
│   ├── 要件.md
│   ├── design.md
│   ├── システム構成.md    # このファイル
│   └── ページ構成.md
├── views/                  # EJSテンプレート
│   ├── layout.ejs         # 共通レイアウト
│   ├── index.ejs          # TOPページ
│   ├── inventory/
│   │   ├── index.ejs      # 在庫一覧ページ
│   │   └── show.ejs       # 在庫詳細ページ
│   ├── admin/
│   │   └── index.ejs      # 管理ページ
│   ├── about.ejs          # 会社概要ページ
│   ├── access.ejs         # アクセスページ
│   ├── contact.ejs        # お問い合わせページ
│   ├── error.ejs          # エラーページ
│   └── 404.ejs            # 404ページ
├── assets/                 # 静的ファイル
│   ├── css/
│   │   └── style.css      # カスタムCSS
│   ├── js/
│   │   └── script.js      # JavaScript
│   └── gallery/           # 画像ファイル
├── database.sqlite        # SQLiteデータベース
├── server.js              # メインサーバーファイル
├── package.json           # Node.js設定
└── init-db.sql           # データベース初期化SQL
```

## 🗄️ データベース構成

### carsテーブル
```sql
CREATE TABLE cars (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,                    -- 車両名
  model TEXT,                           -- モデル名
  year INTEGER,                         -- 年式
  price INTEGER,                        -- 価格
  mileage INTEGER DEFAULT 0,            -- 走行距離
  color TEXT,                           -- 色
  fuel_type TEXT,                       -- 燃料種別
  transmission TEXT,                    -- 変速機
  status TEXT DEFAULT 'available',      -- 在庫状況
  description TEXT,                     -- 説明
  image_path TEXT,                      -- 画像パス
  features TEXT,                        -- 特徴（JSON）
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### 在庫状況ステータス
- `available` - 在庫あり
- `reserved` - 予約中
- `sold` - 売約済み

## 🔄 ルーティング構成

### パブリックルート
- `GET /` - TOPページ
- `GET /inventory` - 在庫一覧ページ
- `GET /inventory/:id` - 在庫詳細ページ
- `GET /about` - 会社概要ページ
- `GET /access` - アクセスページ
- `GET /contact` - お問い合わせページ

### 管理ルート
- `GET /admin` - 管理ページ（在庫管理）
- `POST /admin` - 新規車両追加
- `PUT /admin/:id` - 車両情報更新
- `DELETE /admin/:id` - 車両削除

### エラーハンドリング
- `404` - ページが見つからない場合
- `500` - サーバーエラーの場合

## 🎨 デザインシステム

### カラーシステム
```css
:root {
  /* N-STYLEオリジナルカラースキーム */
  --nstyle-primary: #2c3e50;      /* メインカラー */
  --nstyle-secondary: #3498db;    /* セカンダリー */
  --nstyle-accent: #e74c3c;       /* アクセント */
  --nstyle-success: #27ae60;      /* 成功 */
  --nstyle-warning: #f39c12;      /* 警告 */
  --nstyle-light: #ecf0f1;        /* ライト */
  --nstyle-dark: #34495e;         /* ダーク */
}
```

### レスポンシブデザイン
- Bootstrap 5のグリッドシステムを使用
- モバイルファーストのアプローチ
- ブレークポイント: xs, sm, md, lg, xl

### アニメーション
- CSS transitions（ホバー効果）
- Fade-inアニメーション
- Slide-upアニメーション
- Hover効果（カードの浮き上がり）

## 🔒 セキュリティ対策

### 基本対策
- 入力データの検証
- SQLインジェクション対策（パラメータ化クエリ）
- XSS対策（EJSの自動エスケープ）
- CSRF対策（method-override使用）

### ファイルアップロード
- Multerを使用した安全なファイル処理
- ファイルタイプの検証
- ファイルサイズ制限

## 📊 パフォーマンス最適化

### フロントエンド
- Bootstrap CDN使用
- Font Awesome CDN使用
- Google Fonts CDN使用
- 画像の最適化

### バックエンド
- SQLiteの効率的なクエリ
- ミドルウェアの適切な配置
- エラーハンドリングの最適化

## 🚀 デプロイメント

### 開発環境
```bash
npm install    # 依存関係インストール
npm run dev    # 開発モード起動（自動再起動）
npm start      # 本番モード起動
```

### 本番環境考慮
- 環境変数の使用（.envファイル）
- データベースのバックアップ
- エラーログの監視
- SSL証明書の設定

## 🔧 メンテナンス

### 定期作業
- データベースのバックアップ
- ログファイルの監視
- 依存関係の更新
- セキュリティパッチの適用

### 拡張性
- モジュール化された構造
- RESTful API設計
- データベースのスケーラビリティ
- フロントエンドのコンポーネント化

---

**最終更新**: 2025年10月17日
**バージョン**: 1.0.0
